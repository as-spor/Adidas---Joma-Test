<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>As Spor - Showroom Sistemi</title>

    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#000000">
    <link rel="apple-touch-icon" href="icon-192.png">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    <script src="https://unpkg.com/tesseract.js@v4.0.1/dist/tesseract.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <style>
        :root { --primary: #000; --accent: #00AEEF; --bg: #f8f9fb; --radius: 18px; --success: #2ecc71; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); margin: 0; padding-bottom: 160px; color: #1a1a1a; }

        #debugStatus { background: #f39c12; color: #fff; padding: 10px; text-align: center; font-weight: 700; font-size: 14px; position: fixed; top: 0; left: 0; width: 100%; z-index: 9999; }

        #loginOverlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: var(--primary); z-index: 10000; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px; }
        .login-box { background: #fff; width: 100%; max-width: 350px; padding: 40px 30px; border-radius: 24px; text-align: center; box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
        .login-input { width: 100%; padding: 15px; margin: 10px 0; border: 2px solid #eee; border-radius: 12px; outline: none; font-family: 'Inter'; font-size: 16px; }
        .login-btn { width: 100%; background: var(--accent); color: #fff; padding: 15px; border: none; border-radius: 12px; font-weight: 800; cursor: pointer; margin-top: 10px; font-size: 16px; }

        .header-hero { background: var(--primary); color: #fff; padding: 50px 20px 80px; border-bottom: 6px solid var(--accent); }
        .main-container { max-width: 1200px; margin: 0 auto; padding: 0 15px; }
        .user-welcome-bar { background: #fff; padding: 15px 20px; border-radius: var(--radius); margin-top: -50px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); display: flex; align-items: center; justify-content: space-between; }

        .search-container { background: #fff; padding: 8px; border-radius: var(--radius); margin-top: 20px; display: flex; gap: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.04); }
        .search-field { flex: 1; border: none; padding-left: 15px; outline: none; font-size: 16px; }
        .btn-scan { background: var(--primary); color: #fff; border: none; width: 55px; height: 50px; border-radius: 14px; cursor: pointer; }
        .btn-camera { background: var(--accent); color: #fff; border: none; width: 55px; height: 50px; border-radius: 14px; cursor: pointer; }

        #reader-container { width: 100%; margin-top: 15px; display: none; background: #111; border-radius: 22px; overflow: hidden; }
        #reader-viewport { position: relative; width: 100%; height: 220px; background: #000; }
        #reader { width: 100% !important; height: 220px !important; }
        .scanner-laser { position: absolute; left: 10%; width: 80%; height: 2px; background: red; box-shadow: 0 0 8px red; z-index: 9; animation: laserSweep 1.6s infinite ease-in-out; }
        @keyframes laserSweep { 0%,100%{top:40px} 50%{top:180px} }

        /* ── YENİ: ÜRÜN KARTLARI (BÜYÜK FOTO) ── */
        #resultsArea { display: grid; grid-template-columns: repeat(1, 1fr); gap: 14px; margin-top: 25px; }
        @media(min-width: 600px) { #resultsArea { grid-template-columns: repeat(2, 1fr); } }
        .product-card { background: #fff; border-radius: 20px; overflow: hidden; box-shadow: 0 3px 12px rgba(0,0,0,0.07); border: 1.5px solid #eee; display: flex; flex-direction: column; cursor: pointer; }
        .product-img { width: 100%; height: 280px; object-fit: contain; background: #fff; padding: 15px; border-bottom: 1px solid #f2f2f2; }
        .product-info-wrapper { padding: 15px 18px; }
        .product-code-label { font-size: 11px; color: var(--accent); font-weight: 800; text-transform: uppercase; }
        .product-name-label { font-size: 16px; font-weight: 800; color: #000; margin-top: 4px; }
        .product-ean-label { font-size: 11px; color: #bbb; font-weight: 600; margin-top: 2px; }

        #productModal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.72); z-index: 11000; align-items: flex-end; justify-content: center; }
        #productModal.open { display: flex; }
        #productModalBox { background: #fff; width: 100%; max-width: 560px; border-radius: 28px 28px 0 0; padding-bottom: 40px; max-height: 95vh; overflow-y: auto; position: relative; }
        
        /* ── YENİ: YAN YANA BEDENLER ── */
        .size-grid { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
        .size-btn-row { flex: 1 1 calc(50% - 8px); display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f9f9f9; border-radius: 12px; border: 1px solid #eee; }
        .pm-qty-inp { width: 45px; text-align: center; border: none; background: transparent; height: 38px; font-weight: 800; font-size: 16px; outline: none; }

        /* ── STICKY CART SUMMARY BAR ── */
        #cartSummaryBar { position: fixed; bottom: 0; left: 0; right: 0; background: #000; color: #fff; padding: 15px 20px; display: none; align-items: center; justify-content: space-between; z-index: 9000; border-top: 3px solid var(--accent); }
        #cartSummaryBar.active { display: flex; }

        .cart-group { border: 1.5px solid #eee; border-radius: 18px; margin-bottom: 16px; overflow: hidden; background: #fff; }
        .cart-group-header { background: #fcfcfc; padding: 14px; border-bottom: 1px solid #f5f5f5; display: flex; gap: 12px; align-items: center; }
        .cart-thumb { width: 70px; height: 70px; border-radius: 10px; object-fit: contain; border: 1px solid #eee; background: #fff; }
        .cart-qty-ctrl { display: flex; align-items: center; gap: 10px; background: #f0f0f0; border-radius: 10px; padding: 4px 8px; }
        .btn-qty { width: 28px; height: 28px; border-radius: 8px; border: none; background: #fff; font-weight: 800; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }

        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 12000; }
        .modal-content { background: white; margin: 2% auto; width: 95%; max-width: 550px; padding: 25px; border-radius: 24px; max-height: 90vh; overflow-y: auto; }

        #toast { visibility: hidden; min-width: 250px; background: #000; color: #fff; text-align: center; border-radius: 50px; padding: 16px; position: fixed; z-index: 20000; left: 50%; bottom: 130px; transform: translateX(-50%); font-weight: 600; }
        #toast.show { visibility: visible; }
    </style>
</head>
<body>

<div id="debugStatus">⏳ Veriler Yükleniyor...</div>

<div id="loginOverlay">
    <div class="login-box">
        <h2 style="margin:0;font-weight:800;">AS SPOR</h2>
        <p style="color:#666;font-size:13px;margin-bottom:20px;">Showroom Personel Girişi</p>
        <input type="text" id="loginUser" class="login-input" placeholder="Kullanıcı Adı" autocomplete="off">
        <input type="password" id="loginPass" class="login-input" placeholder="Şifre">
        <button onclick="checkLogin()" class="login-btn">GİRİŞ YAP</button>
        <div id="loginError" style="color:red; display:none; margin-top:10px;"></div>
    </div>
</div>

<div class="header-hero"><div class="main-container"><h1 style="margin:0;">AS SPOR</h1></div></div>

<div class="main-container">
    <div class="user-welcome-bar">
        <div><b>Sorumlu:</b> <span id="displayUserName">-</span></div>
        <div style="display:flex;gap:10px;">
            <button onclick="openHistory()" style="background:#eee;border:none;padding:8px 12px;border-radius:8px;font-weight:600;cursor:pointer;font-size:12px;">Geçmiş</button>
            <button onclick="logout()" style="color:red;border:none;background:none;cursor:pointer;font-weight:700;">ÇIKIŞ</button>
        </div>
    </div>

    <input type="text" id="dealerName" class="login-input" style="margin-top:15px;background:#fff;" placeholder="Bayi Adı (Zorunlu)" oninput="persistDealer()">

    <div class="search-container">
        <input type="text" id="searchInput" class="search-field" placeholder="Ürün Kodu, İsim veya Barkod Ara...">
        <button class="btn-scan" onclick="searchProduct()"><i class="fas fa-search"></i></button>
        <button class="btn-camera" onclick="toggleCamera()"><i class="fas fa-camera"></i></button>
    </div>

    <div id="reader-container">
        <div id="reader-viewport"><div id="reader"></div><div class="scanner-laser"></div></div>
        <button onclick="toggleCamera()" style="width:100%;background:#222;color:#ccc;border:none;padding:15px;font-weight:700;">KAPAT</button>
    </div>

    <div id="resultsArea"></div>
</div>

<div id="cartSummaryBar" onclick="openCart()">
    <div>
        <span id="st-qty" style="font-weight:800; font-size:18px;">0</span> <span style="font-size:14px; opacity:0.8;">ADET ÜRÜN</span>
    </div>
    <div style="text-align:right;">
        <div style="font-size:12px; opacity:0.7;">TOPLAM TUTAR</div>
        <div id="st-total" style="font-weight:900; font-size:20px; color:var(--accent);">0.00 TL</div>
    </div>
</div>

<div id="cartModal" class="modal">
    <div class="modal-content">
        <span onclick="closeModal('cartModal')" style="float:right;cursor:pointer;font-size:28px;">&times;</span>
        <h2 style="margin:0 0 15px;font-weight:800;">Sepetim</h2>
        <div id="cartItems"></div>
        <div style="margin-top:20px;text-align:right;font-size:22px;font-weight:800;">GENEL TOPLAM: <span id="cartTotal" style="color:var(--accent);">0.00</span></div>
        <button id="btnConfirmOrder" onclick="confirmAndLockOrder()" style="width:100%;background:#000;color:#fff;padding:18px;border-radius:15px;font-weight:800;margin-top:20px;border:none;">SİPARİŞİ ONAYLA</button>
        <div id="postConfirmActions" style="display:none; flex-direction:column; gap:10px; margin-top:15px;">
            <input type="email" id="customerEmail" class="login-input" placeholder="Müşteri Maili (Opsiyonel)">
            <div style="display:flex;gap:12px;">
                <button onclick="saveAndExport()" style="flex:1;background:#2ecc71;color:#fff;border:none;padding:15px;border-radius:12px;font-weight:800;">EXCEL</button>
                <button onclick="sendMail()" id="btnMail" style="flex:1;background:#000;color:#fff;border:none;padding:15px;border-radius:12px;font-weight:800;">MAİL AT</button>
            </div>
            <button onclick="confirmClearCart()" style="width:100%;background:#fff;color:red;border:2px solid red;padding:15px;border-radius:12px;font-weight:800;margin-top:20px;">SEPETİ TEMİZLE</button>
        </div>
    </div>
</div>

<div id="historyModal" class="modal"><div class="modal-content"><span onclick="closeModal('historyModal')" style="float:right;cursor:pointer;font-size:28px;">&times;</span><h2 style="font-weight:800;">Geçmiş</h2><div id="historyList"></div></div></div>

<div id="productModal">
    <div id="productModalBox">
        <span onclick="_closeProductModal()" style="position:absolute;top:15px;right:20px;font-size:32px;cursor:pointer;z-index:10;">&times;</span>
        <img id="productModalImg" src="" style="width:100%;height:350px;object-fit:contain;background:#fff;padding:10px;">
        <div style="padding:20px;">
            <div id="pm-code" style="color:var(--accent);font-weight:800;font-size:12px;"></div>
            <div id="pm-name" style="font-size:22px;font-weight:800;margin:4px 0;"></div>
            <div id="pm-ean" style="font-size:12px;color:#aaa;"></div>
            <div id="pm-desc" style="font-size:14px;color:#666;margin:10px 0;line-height:1.4;"></div>
            <div id="pm-price" style="font-size:28px;font-weight:900;color:#000;margin-bottom:20px;"></div>
            <div style="font-weight:800; margin-bottom:10px;">BEDEN SEÇİMİ</div>
            <div id="pm-sizes" class="size-grid"></div>
            <button onclick="addToCartFromModal()" style="width:100%;background:#000;color:#fff;border:none;padding:18px;border-radius:15px;font-weight:800;margin-top:25px;">SEPETE EKLE</button>
        </div>
    </div>
</div>

<div id="toast"></div>

<script>
const EMAILJS_SVC = "service_qh7mngr", EMAILJS_TMP = "template_2e5jxvh", EMAILJS_KEY = "VSRTcl2JLxhmNWT4a";
const USERS = { "adnankaya": "1234", "cinargokce": "1234", "lutfuozturk": "1234", "meftunicay": "1234", "muratturgut": "1234", "ozkanocak": "1234", "serkanmert": "1234", "admin": "1234" };

let inventory = [], cart = [], currentU = null, html5QrCode = null, modalCode = null, groupedResults = {};
const beep = new Audio("https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3");

window.onload = function() {
    emailjs.init(EMAILJS_KEY);
    const saved = localStorage.getItem('as_active_user');
    if(saved) loginSuccess(saved);

    Papa.parse('data.csv', {
        download: true, header: true, delimiter: ";", skipEmptyLines: 'greedy',
        complete: (r) => { inventory = r.data.filter(row => row['Product'] || row['Reference'] || row['EAN']); document.getElementById('debugStatus').style.display='none'; }
    });

    // FIX: Enter Key Support
    document.getElementById("searchInput").addEventListener("keypress", (e) => { if(e.key === "Enter") searchProduct(); });
};

function checkLogin() {
    const u = document.getElementById('loginUser').value.trim().toLowerCase();
    const p = document.getElementById('loginPass').value;
    if(USERS[u] && USERS[u] === p) { localStorage.setItem('as_active_user', u); loginSuccess(u); }
    else { document.getElementById('loginError').style.display='block'; document.getElementById('loginError').innerText="Hatalı!"; }
}

function loginSuccess(u) {
    currentU = u;
    document.getElementById('displayUserName').innerText = u.toUpperCase();
    document.getElementById('loginOverlay').style.display='none';
    const savedCart = localStorage.getItem('as_cart_' + u);
    cart = savedCart ? JSON.parse(savedCart) : [];
    const savedDealer = localStorage.getItem('as_dealer_' + u);
    document.getElementById('dealerName').value = savedDealer || "";
    updateCartUI();
}

function persistCart() { if(currentU) localStorage.setItem('as_cart_' + currentU, JSON.stringify(cart)); }
function persistDealer() { if(currentU) localStorage.setItem('as_dealer_' + currentU, document.getElementById('dealerName').value); }
function logout() { localStorage.removeItem('as_active_user'); location.reload(); }

function searchProduct() {
    const q = document.getElementById('searchInput').value.toUpperCase().trim();
    if(!q) return;
    // FIX: Search by Product, Description, or EAN (Barkod)
    const matches = inventory.filter(i => 
        (i.Product||"").toUpperCase().includes(q) || 
        (i.Description||"").toUpperCase().includes(q) || 
        (i.EAN||"").includes(q)
    );
    if(matches.length === 0) return showToast("Bulunamadı!");
    groupedResults = {};
    matches.forEach(item => { const c = item.Product || item.Reference; if(!groupedResults[c]) groupedResults[c] = []; groupedResults[c].push(item); });
    renderResults();
}

function renderResults() {
    const area = document.getElementById('resultsArea'); area.innerHTML = "";
    Object.keys(groupedResults).forEach(code => {
        const g = groupedResults[code], f = g[0];
        const card = document.createElement('div'); card.className = 'product-card';
        card.onclick = () => openProductModal(code);
        card.innerHTML = `
            <img src="${f.ImageURL || ''}" class="product-img">
            <div class="product-info-wrapper">
                <p class="product-code-label">${code}</p>
                <p class="product-name-label">${f.Description}</p>
                <p class="product-ean-label">EAN: ${f.EAN || '-'}</p>
                <span style="font-size:18px; font-weight:900; color:#000; margin-top:12px; display:block;">${f['Tariff Price']} ${f['Currency']}</span>
            </div>`;
        area.appendChild(card);
    });
}

function openProductModal(code) {
    const g = groupedResults[code], f = g[0]; modalCode = code;
    document.getElementById('productModalImg').src = f.ImageURL || '';
    document.getElementById('pm-code').innerText = code;
    document.getElementById('pm-name').innerText = f.Description;
    document.getElementById('pm-ean').innerText = "EAN: " + (f.EAN || '-');
    document.getElementById('pm-desc').innerText = f['Long Description'] || '';
    document.getElementById('pm-price').innerText = f['Tariff Price'] + " " + f['Currency'];
    // FIX: Sizes Display Yan yana (Grid)
    document.getElementById('pm-sizes').innerHTML = g.map((item, idx) => `
        <div class="size-btn-row">
            <span style="font-weight:800; font-size:14px;">${item['EUR Size']} <br><small style="color:#888">Stok: ${item['Stock Quantity']}</small></span>
            <input type="number" id="pm-qty-${idx}" class="pm-qty-inp" value="0" min="0" 
                   onfocus="if(this.value=='0')this.value=''" 
                   onblur="if(this.value=='')this.value='0'">
        </div>`).join('');
    document.getElementById('productModal').classList.add('open');
}

function _closeProductModal() { document.getElementById('productModal').classList.remove('open'); }

function addToCartFromModal() {
    const d = document.getElementById('dealerName').value.trim();
    if(!d) return showToast("⚠️ Önce Bayi Adı Girin!");
    let add = 0;
    groupedResults[modalCode].forEach((item, idx) => {
        const q = parseInt(document.getElementById(`pm-qty-${idx}`).value);
        if(q > 0) { 
            // Mevcut sepette varsa üzerine ekle
            let exist = cart.find(x => x.Product === item.Product && x['EUR Size'] === item['EUR Size']);
            if(exist) exist.qty += q;
            else cart.push({ ...item, qty: q, price: parseFloat(item['Tariff Price']), dealer: d }); 
            add += q; 
        }
    });
    if(add > 0) { 
        updateCartUI(); persistCart(); 
        document.getElementById('btnConfirmOrder').style.display='block';
        document.getElementById('postConfirmActions').style.display='none';
        showToast(`✅ ${add} Ürün Eklendi`); 
        _closeProductModal(); 
    }
}

function updateCartUI() {
    const count = cart.reduce((a, b) => a + b.qty, 0);
    const total = cart.reduce((a, b) => a + (b.price * b.qty), 0);
    const totalStr = total.toFixed(2) + " " + (cart[0]?.Currency || "TL");
    
    document.getElementById('cartTotal').innerText = totalStr;
    document.getElementById('st-qty').innerText = count;
    document.getElementById('st-total').innerText = totalStr;
    document.getElementById('cartSummaryBar').classList.toggle('active', count > 0);
}

function openCart() {
    const list = document.getElementById('cartItems');
    if(cart.length === 0) { list.innerHTML = "<p style='text-align:center;padding:20px;'>Sepet boş.</p>"; }
    else {
        const groups = {};
        cart.forEach(i => { const c = i.Product; if(!groups[c]) groups[c] = { name: i.Description, img: i.ImageURL, items: [], subTotal: 0, subQty: 0 }; groups[c].items.push(i); groups[c].subTotal += (i.price * i.qty); groups[c].subQty += i.qty; });
        
        list.innerHTML = Object.keys(groups).map(c => `
            <div class="cart-group">
                <div class="cart-group-header">
                    <img src="${groups[c].img || ''}" class="cart-thumb">
                    <div style="flex:1">
                        <div style="font-size:11px;font-weight:800;color:var(--accent);">${c}</div>
                        <div style="font-weight:800; font-size:14px;">${groups[c].name}</div>
                        <div style="font-size:12px; color:#555; margin-top:4px;"><b>${groups[c].subQty} ADET</b> - ${groups[c].subTotal.toFixed(2)} ${cart[0].Currency}</div>
                    </div>
                </div>
                ${groups[c].items.map(it => `
                    <div style="display:flex;justify-content:space-between;padding:12px 14px;border-bottom:1px solid #f9f9f9;align-items:center;">
                        <span style="font-weight:700;">Beden: ${it['EUR Size']} <small style="color:#aaa">(Stok: ${it['Stock Quantity']})</small></span>
                        <div class="cart-qty-ctrl">
                            <button class="btn-qty" onclick="changeCartQty('${it.Product}', '${it['EUR Size']}', -1)">-</button>
                            <input type="number" class="pm-qty-inp" value="${it.qty}" onchange="changeCartQty('${it.Product}', '${it['EUR Size']}', this.value, true)">
                            <button class="btn-qty" onclick="changeCartQty('${it.Product}', '${it['EUR Size']}', 1)">+</button>
                        </div>
                    </div>`).join('')}
            </div>`).join('');
    }
    document.getElementById('cartModal').style.display='block';
}

function changeCartQty(code, size, val, isManual = false) {
    let item = cart.find(x => x.Product === code && x['EUR Size'] === size);
    if(!item) return;
    if(isManual) item.qty = Math.max(0, parseInt(val) || 0);
    else item.qty = Math.max(0, item.qty + val);
    
    if(item.qty === 0) cart = cart.filter(x => x !== item);
    persistCart(); updateCartUI(); openCart();
}

function confirmAndLockOrder() {
    if(cart.length === 0) return;
    document.getElementById('btnConfirmOrder').style.display = 'none';
    document.getElementById('postConfirmActions').style.display = 'flex';
    showToast("✓ Sipariş Onaylandı.");
}

function confirmClearCart() {
    if(confirm("Tüm sepeti temizleyip yeni satışa başlamak istiyor musunuz?")) {
        cart = []; persistCart(); updateCartUI(); closeModal('cartModal');
    }
}

function saveAndExport() {
    const ws = XLSX.utils.json_to_sheet(cart);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Siparis");
    XLSX.writeFile(wb, `AsSpor_${document.getElementById('dealerName').value}.xlsx`);
}

function sendMail() {
    const btn = document.getElementById('btnMail'); btn.disabled = true;
    let table = `<table border="1" style="border-collapse:collapse;width:100%;"><tr><th>Kod</th><th>Ürün</th><th>Beden</th><th>Adet</th></tr>`;
    cart.forEach(i => table += `<tr><td>${i.Product}</td><td>${i.Description}</td><td>${i['EUR Size']}</td><td>${i.qty}</td></tr>`);
    table += `</table>`;
    emailjs.send(EMAILJS_SVC, EMAILJS_TMP, { manager: currentU.toUpperCase(), dealer: document.getElementById('dealerName').value, order_details: table }).then(() => {
        showToast("✅ Sipariş Maili Atıldı!");
    }).finally(()=> btn.disabled = false);
}

function toggleCamera() {
    const container = document.getElementById('reader-container');
    if(html5QrCode) { html5QrCode.stop(); html5QrCode = null; container.style.display='none'; return; }
    container.style.display='block';
    html5QrCode = new Html5Qrcode("reader");
    html5QrCode.start({ facingMode: "environment" }, { fps: 20, qrbox: { width: 250, height: 100 } }, (txt) => {
        beep.play().catch(()=>{}); document.getElementById('searchInput').value = txt; searchProduct(); toggleCamera();
    });
}

function openHistory() { alert("Gelişmiş geçmiş modülü yükleniyor..."); }
function closeModal(id) { document.getElementById(id).style.display='none'; }
function showToast(m) { const t = document.getElementById("toast"); t.innerText = m; t.className = "show"; setTimeout(()=>t.className="", 3000); }
</script>
</body>
</html>